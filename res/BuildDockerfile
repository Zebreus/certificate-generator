FROM archlinux
MAINTAINER Lennart E.

#get reflector for fastest mirror
RUN pacman -Sy && pacman -S --noconfirm reflector

#get latex, thrift, boost(for thrift), docker and the build tools
RUN reflector --latest 10 --sort rate --save /etc/pacman.d/mirrorlist && pacman -Sy && pacman -S --noconfirm thrift boost base-devel git diffutils gtest docker

#remove reflector
RUN pacman -Rns --noconfirm reflector

#add entrypoint script for docker in docker
RUN git clone https://github.com/karlkfi/concourse-dcind.git ;\
	cp concourse-dcind/entrypoint.sh /bin/entrypoint.sh ;\
	chmod a+x /bin/entrypoint.sh ;\
	rm -rf concourse-dcint

#set working directory
WORKDIR /src/
ENTRYPOINT ["entrypoint.sh"]
